<div class="container-fluid">
    
    <%= render partial: 'header', locals: { entity: @entity } %>
    <%= render partial: 'actions', locals: { entity: @entity, current_user: @current_user } %>
    <div class="row top-1em">
        <h2>Match Donations From OpenSecrets.org</h2>
        <br>
        <div class="col-md-4 col-sm-4">
            <a href="http://opensecrets.org"><img style="border: 0; padding-right: 0.5em;" src="//s3.amazonaws.com/pai-littlesis/images/system/opensecrets-logo-225.gif" alt="Opensecrets-logo-225" align="left"></a>
            
        </div>
        <div class="col-md-6 col-sm-6">
            <p>Below are donor records from <a href="http://opensecrets.org">OpenSecrets</a> with the same or similar name.
                Using the info already in LittleSis, and the employer info, addresses, and filing sources from OpenSecrets, identify which of these donor records belong to this person, select them, and then click the button "match donations".</p>
            <p class="bg-info"><%= link_to "Click here", review_donations_entity_path(@entity) %> to review donations that have already been matched.</p>
        </div>
        <div class="col-md-2 col-sm-2"></div>
    </div>
    
    <div class="row top-1em">
        <div class="col-md-9 col-sm-9">
            <div id="match-donations" data-entityid="<%= @entity.id %>">
                <table id="donations-table" class="display" width="100%"></table>
            </div>
            <script>matchDonations.init();</script>
        </div>
        <div class="col-md-3 col-sm-3" id="about-sidebar">
            <div class="row thin-grey-bottom-border">
                <h3 class="text-center"><%= @entity.name %></h3>
                <% cache @entity.person do %>
                    <%= render partial: 'about_sidebar', locals: { person: @entity.person } %>
                <% end %>
            </div>
            <br>
            <% if @entity.relationships.where('relationship.category_id = 1 OR relationship.category_id = 3').present? %>
                <div class="row text-center">
                    <p class=""><strong>Positions</strong></p>
                    <% @entity.relationships.where('relationship.category_id = 1 OR relationship.category_id = 3').each do |r|  %>
                        <% cache r do %>
                            <%= render partial: 'position', locals: { relationship: r } %>
                        <% end %>
                    <% end %>
                </div>
            <% end %>

            <% if @entity.relationships.where(category_id: 2).present? %>
                <div class="row text-center">
                    <p><strong>Education</strong></p>
                    <% @entity.relationships.where(category_id: 2).each do |r|  %>
                        <% cache r do %>
                            <%= render partial: 'position', locals: { relationship: r } %>
                        <% end %>
                    <% end %>
                </div>    
            <% end %>

            <% if @entity.relationships.where(category_id: 4).present? %>
                <div class="row text-center">
                    <p><strong>Family</strong></p>
                    <% @entity.relationships.where(category_id: 2).each do |r|  %>
                        <% cache r do %>
                            <%= render partial: 'position', locals: { relationship: r } %>
                        <% end %>
                    <% end %>
                </div>
            <% end %>
            
        </div>
    </div>
</div>
